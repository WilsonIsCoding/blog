---
title: 資料密集型系統設計-交易
description: 資料密集型系統設計-交易
slug: data-intensive-systems-design-transaction
date: 2026-02-17
type: Post
---

## 前言
<p>對於資工系本科的人來說，交易這件事情應該不會陌生，最常聽到的就是ACID原則，他是指我們在資料庫的操作上，安全保證上我們所會運用的特性。</p>
<p>因為有別於一般的資料庫操作，交易需要具備ACID原則，才能確保資料的一致性和可靠性。</p>

## ACID 原則
<h3>原子性（Atomicity）</h3>
<p>是指一個交易要麼完全成功，要麼完全失敗，不會有中間狀態。這確保了資料的一致性，避免了部分更新導致的資料不完整或錯誤。</p>
<h3>一致性（Consistency）</h3>
<p>是指交易在執行前後，資料庫的狀態必須保持一致。這意味著交易必須遵守資料庫的約束條件和規則，確保資料的完整性和正確性。</p>
<h3>隔離性（Isolation）</h3>
<p>是指同時執行的交易之間不會互相干擾。每個交易應該像是獨立運行的，確保了資料的一致性和正確性。</p>
<h3>持久性（Durability）</h3>
<p>是指一旦交易完成，對資料庫的修改將永久保存在資料庫中，即使系統崩潰也不會丟失。這確保了資料的可靠性和持久性。</p>
<h2><b>原子性、隔離性跟持久性是資料庫的屬性，通常在底層 資料庫會自己幫我們處理好，但是一致性是應用程式的特性，也就是說，這個特質會是我們自己在設計程式時要自己處理好的</b></h2>

## 交易的錯誤場景
<h2>髒讀（Dirty Read）</h2>
<p>當一個交易讀取了另一個尚未提交的交易所修改的資料，這種情況稱為髒讀。這可能導致資料不一致，因為如果第二個交易最終回滾，那麼第一個交易讀取的資料就會變得無效。</p>
<p>假設有一個紀錄信箱未讀數量的一個功能，但我發現要去計算未讀數量的這個操作要花太久時間了，於是我打算另外拉一個欄位(unread_number)來加速查詢，但也就代表 資料的更新跟這個數字的更新彼此會存在時間差</p>
<p>而髒讀就是指，當我select未讀信件時，我有找到一筆尚未讀取的信件，但是卻還沒有更新到unread_number，所以會造成，實際有未讀信件，但是數字卻存在0的誤差，這就是違反了隔離性的原則</p>
