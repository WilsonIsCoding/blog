---
title: SSR、CSR實作
description: 樂居nuxt3 SSR與CSR撰寫過程流程
slug: nuxt3-CSR
date: 2024-08-11
type: Post
---

## 起因
<p>在樂居的網站上，大部分的網頁其實都可以交給客戶端的電腦去執行，並沒有非常強烈的SEO需求，但其實還是有幾個頁面，可能是客戶有買廣告、可能是首頁我們很明顯需要品牌曝光，我們需要在注重SEO效能這件事情，那我們就會採取SSR的方式</p>

## 執行背景
<p>這次要做的頁面在樂居叫做「到達頁」，他是一個在地圖上點選建案之後會打開的頁面，裡面會出現這個建案的詳細資訊(包含總價、地址、房屋資訊等等)
如果之後10月份上線的話，網址應該是</p>
[這個](https://www.leju.com.tw/community/Lba63399dbf71)

## 執行經過
<p>也因為需要做到SSR這件事情，而通常使用者「不會只有透過網址就進入該網站(SSR)」的唯一途徑，而是可能透過網站的樹狀圖從上方的相關結點進來(CSR)，所以我們的做法是拆成同樣的資料回傳，但是分成CSR(需要token)和SSR(走internal API，不用token)的方式來分流，避免SERVER端直接面對單一來源的請求直接被打爆，而做這種頁面也就代表，一個頁面我們會需要做兩種方式的進入方式的SEO跟資料都要能夠同步跟一致，花了一點時間看了nuxt的的server渲染方式，主要是如果沒有特別去分類程式碼的執行環境，蠻容易在client端覆寫server就已經渲染的資料畫面，而且需要知道的是，vue的生命週期是到客戶端mount，所以在server端拿到的資料要記得存放在store裡面，ref、computed宣告的變數在server端請求時都是還沒出現的</p>

## 一些想法
<p>上面的那個頁面其實實作了很多功能，SEO、延遲載入、image壓縮，其實尤其是做到CSR跟SSR時 對整個畫面渲染的過程有更深的理解。</p>
